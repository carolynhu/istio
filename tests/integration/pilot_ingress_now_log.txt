2020-11-24T18:48:48.191539Z	info	tf	=== Test Framework Settings ===
2020-11-24T18:48:48.191592Z	info	tf	TestID:            pilot_ingress
RunID:             412209cf-2c26-4803-a0fb-8c3149f7585d
NoCleanup:         true
BaseDir:           /tmp
Selector:          
FailOnDeprecation: false

2020-11-24T18:48:48.191607Z	info	tf	===============================
2020-11-24T18:48:48.191695Z	info	tf	Test run dir: /tmp/pilot-ingress-412209cf2c264803a
2020-11-24T18:48:48.191764Z	info	tf	Test Framework Kubernetes environment Settings:
KubeConfig:           [/root/bmctl-workspace/asm7-build71/asm7-build71-kubeconfig]
MiniKubeIngress:      false
ControlPlaneTopology: map[0:0]
NetworkTopology:      map[]

2020-11-24T18:48:48.193900Z	info	tf	=== BEGIN: Setup: 'pilot_ingress' ===
2020-11-24T18:48:53.042602Z	info	tf	=== BEGIN: Deploy Istio [Suite=pilot_ingress] ===
2020-11-24T18:48:53.042658Z	info	tf	=== Istio Component Config ===
2020-11-24T18:48:53.042685Z	info	tf	
SystemNamespace:                istio-system
IstioNamespace:                 istio-system
ConfigNamespace:                istio-system
TelemetryNamespace:             istio-system
PolicyNamespace:                istio-system
IngressNamespace:               istio-system
EgressNamespace:                istio-system
DeployIstio:                    true
DeployTimeout:                  5m0s
UndeployTimeout:                5m0s
Values:                         map[global.hub:gcr.io/mixologist-142215/baremetal_asm global.imagePullPolicy:Always global.tag:1.7.3 pilot.env.PILOT_ENABLED_SERVICE_APIS:true]
IOPFile:                        tests/integration/iop-integration-test-defaults.yaml
SkipWaitForValidationWebhook:   false
CustomSidecarInjectorNamespace: 

2020-11-24T18:48:53.042690Z	info	tf	================================
2020-11-24T18:48:53.043536Z	info	proto: tag has too few fields: "-"
2020-11-24T18:48:53.471740Z	info	tf	Running istio control plane on cluster cluster-0 [install --skip-confirmation -f /root/go_projects/src/istio.io/istio/tests/integration/iop-integration-test-defaults.yaml -f /tmp/pilot-ingress-412209cf2c264803a/_suite_context/istio-deployment-652750380/iop.yaml --set values.global.imagePullPolicy=Always --manifests /root/go_projects/src/istio.io/istio/manifests --set values.global.hub=gcr.io/mixologist-142215/baremetal_asm --set values.global.tag=1.7.3 --set values.global.imagePullPolicy=Always --set values.pilot.env.PILOT_ENABLED_SERVICE_APIS=true]

- Processing resources for Istio core.
✔ Istio core installed
- Processing resources for Istiod.
- Processing resources for Istiod. Waiting for Deployment/istio-system/istiod
✔ Istiod installed
- Processing resources for Ingress gateways.
- Processing resources for Ingress gateways. Waiting for Deployment/istio-sys...
✔ Ingress gateways installed
- Pruning removed resources
✔ Installation complete2020-11-24T18:49:24.070969Z	info	tf	Creating dummy rule to check for validation webhook readiness
2020-11-24T18:49:24.140045Z	info	tf	Creating dummy rule to check for validation webhook readiness
2020-11-24T18:49:24.202495Z	info	tf	=== SUCCEEDED: Deploy Istio [Suite=pilot_ingress]===
2020-11-24T18:49:24.202539Z	info	tf	=== DONE: Setup: 'pilot_ingress' (36.008607363s) ===
2020-11-24T18:49:24.202544Z	info	tf	=== BEGIN: Test Run: 'pilot_ingress' ===
2020-11-24T18:49:24.202716Z	info	tf	=== BEGIN: Test: 'pilot_ingress[TestGateway]' ===
2020-11-24T18:49:24.290949Z	info	tf	Checking pods ready...
2020-11-24T18:49:24.291001Z	info	tf	Checking pods ready...
2020-11-24T18:49:24.299623Z	info	tf	Failed retrieving pods: no pods found for [app=server]
2020-11-24T18:49:25.299691Z	info	tf	Checking pods ready...
2020-11-24T18:49:25.299753Z	info	tf	Checking pods ready...
2020-11-24T18:49:25.305602Z	info	tf	  [ 0]                    server-v1-755cf59b97-6zkp6         Pending (Pending)
2020-11-24T18:49:26.305771Z	info	tf	Checking pods ready...
2020-11-24T18:49:26.305813Z	info	tf	Checking pods ready...
2020-11-24T18:49:26.311793Z	info	tf	  [ 0]                    server-v1-755cf59b97-6zkp6         Pending (Pending)
2020-11-24T18:49:27.311985Z	info	tf	Checking pods ready...
2020-11-24T18:49:27.312030Z	info	tf	Checking pods ready...
2020-11-24T18:49:27.317462Z	info	tf	  [ 0]                    server-v1-755cf59b97-6zkp6         Running (container not ready: 'app')
2020-11-24T18:49:28.317688Z	info	tf	Checking pods ready...
2020-11-24T18:49:28.317730Z	info	tf	Checking pods ready...
2020-11-24T18:49:28.324154Z	info	tf	  [ 0]                    server-v1-755cf59b97-6zkp6         Running (container not ready: 'app')
2020-11-24T18:49:29.324316Z	info	tf	Checking pods ready...
2020-11-24T18:49:29.324372Z	info	tf	Checking pods ready...
2020-11-24T18:49:29.330736Z	info	tf	  [ 0]                    server-v1-755cf59b97-6zkp6         Running (container not ready: 'app')
2020-11-24T18:49:30.330893Z	info	tf	Checking pods ready...
2020-11-24T18:49:30.330951Z	info	tf	Checking pods ready...
2020-11-24T18:49:30.336645Z	info	tf	  [ 0]                    server-v1-755cf59b97-6zkp6         Running (container not ready: 'app')
2020-11-24T18:49:31.336839Z	info	tf	Checking pods ready...
2020-11-24T18:49:31.336895Z	info	tf	Checking pods ready...
2020-11-24T18:49:31.342813Z	info	tf	  [ 0]                    server-v1-755cf59b97-6zkp6         Running (container not ready: 'app')
2020-11-24T18:49:32.343023Z	info	tf	Checking pods ready...
2020-11-24T18:49:32.343067Z	info	tf	Checking pods ready...
2020-11-24T18:49:32.348969Z	info	tf	  [ 0]                    server-v1-755cf59b97-6zkp6         Running (Ready)
2020-11-24T18:49:33.367888Z	info	tf	=== DONE (failed):  Test: 'pilot_ingress[TestGateway] (9.165168214s)' ===
2020-11-24T18:49:33.367941Z	error	tf	=== Dumping Namespace gateway-1-4132 State...
--- FAIL: TestGateway (9.80s)
    ingress_test.go:138: failed applying YAML to cluster cluster-0: error validating "/tmp/pilot-ingress-412209cf2c264803a/TestGateway/tmpyaml_112125833": error validating data: ValidationError(Gateway.spec.listeners[0].routes): unknown field "namespaceSelector" in io.x-k8s.networking.v1alpha1.Gateway.spec.listeners.routes; if you choose to ignore these errors, turn validation off with --validate=false: gatewayclass.networking.x-k8s.io/istio unchanged
        
2020-11-24T18:49:34.007165Z	info	tf	=== BEGIN: Test: 'pilot_ingress[TestIngress]' ===
2020-11-24T18:49:34.092423Z	info	tf	Checking pods ready...
2020-11-24T18:49:34.092459Z	info	tf	Checking pods ready...
2020-11-24T18:49:34.098142Z	info	tf	Failed retrieving pods: no pods found for [app=server]
2020-11-24T18:49:35.098297Z	info	tf	Checking pods ready...
2020-11-24T18:49:35.098359Z	info	tf	Checking pods ready...
2020-11-24T18:49:35.103751Z	info	tf	  [ 0]                    server-v1-755cf59b97-c69m8         Pending (Pending)
2020-11-24T18:49:36.103949Z	info	tf	Checking pods ready...
2020-11-24T18:49:36.103995Z	info	tf	Checking pods ready...
2020-11-24T18:49:36.109857Z	info	tf	  [ 0]                    server-v1-755cf59b97-c69m8         Pending (Pending)
2020-11-24T18:49:37.110111Z	info	tf	Checking pods ready...
2020-11-24T18:49:37.110160Z	info	tf	Checking pods ready...
2020-11-24T18:49:37.116153Z	info	tf	  [ 0]                    server-v1-755cf59b97-c69m8         Pending (Pending)
2020-11-24T18:49:38.116360Z	info	tf	Checking pods ready...
2020-11-24T18:49:38.116404Z	info	tf	Checking pods ready...
2020-11-24T18:49:38.122186Z	info	tf	  [ 0]                    server-v1-755cf59b97-c69m8         Running (container not ready: 'app')
2020-11-24T18:49:39.122403Z	info	tf	Checking pods ready...
2020-11-24T18:49:39.122455Z	info	tf	Checking pods ready...
2020-11-24T18:49:39.128813Z	info	tf	  [ 0]                    server-v1-755cf59b97-c69m8         Running (container not ready: 'app')
2020-11-24T18:49:40.129040Z	info	tf	Checking pods ready...
2020-11-24T18:49:40.129084Z	info	tf	Checking pods ready...
2020-11-24T18:49:40.134685Z	info	tf	  [ 0]                    server-v1-755cf59b97-c69m8         Running (container not ready: 'app')
2020-11-24T18:49:41.134846Z	info	tf	Checking pods ready...
2020-11-24T18:49:41.134907Z	info	tf	Checking pods ready...
2020-11-24T18:49:41.140551Z	info	tf	  [ 0]                    server-v1-755cf59b97-c69m8         Running (container not ready: 'app')
2020-11-24T18:49:42.140757Z	info	tf	Checking pods ready...
2020-11-24T18:49:42.140806Z	info	tf	Checking pods ready...
2020-11-24T18:49:42.146896Z	info	tf	  [ 0]                    server-v1-755cf59b97-c69m8         Running (container not ready: 'app')
2020-11-24T18:49:43.147160Z	info	tf	Checking pods ready...
2020-11-24T18:49:43.147219Z	info	tf	Checking pods ready...
2020-11-24T18:49:43.152895Z	info	tf	  [ 0]                    server-v1-755cf59b97-c69m8         Running (Ready)
2020-11-24T18:49:44.187981Z	info	tf	=== BEGIN: Test: 'pilot_ingress[TestIngress/http]' ===
2020-11-24T18:49:44.436240Z	info	tf	=== DONE (passed):  Test: 'pilot_ingress[TestIngress/http] (248.250415ms)' ===
2020-11-24T18:49:44.436439Z	info	tf	=== BEGIN: Test: 'pilot_ingress[TestIngress/https-foo]' ===
2020-11-24T18:49:44.454203Z	info	tf	=== DONE (passed):  Test: 'pilot_ingress[TestIngress/https-foo] (17.756207ms)' ===
2020-11-24T18:49:44.454349Z	info	tf	=== BEGIN: Test: 'pilot_ingress[TestIngress/https-bar]' ===
2020-11-24T18:49:44.478009Z	info	tf	=== DONE (passed):  Test: 'pilot_ingress[TestIngress/https-bar] (23.654172ms)' ===
2020-11-24T18:49:44.478156Z	info	tf	=== BEGIN: Test: 'pilot_ingress[TestIngress/https-namedport]' ===
2020-11-24T18:49:44.485230Z	info	tf	=== DONE (passed):  Test: 'pilot_ingress[TestIngress/https-namedport] (7.068062ms)' ===
2020-11-24T18:49:44.899578Z	info	tf	=== DONE (passed):  Test: 'pilot_ingress[TestIngress] (10.892399958s)' ===
FAIL
2020-11-24T18:49:44.899659Z	info	tf	=== FAILED: Test Run: 'pilot_ingress' (exitCode: 1) ===
2020-11-24T18:49:44.899669Z	info	tf	=== Suite "pilot_ingress" run time: 56.705767761s ===
FAIL	istio.io/istio/tests/integration/pilot/ingress	56.823s
FAIL
